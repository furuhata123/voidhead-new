<!DOCTYPE html>
<html lang="zh">
  <head>
    <meta charset="UTF-8"/>
    <title>CSS Debug Handbook - Layout Essentials</title>
    <link rel="stylesheet" href="/assets/blog-post.css">

    <link href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism-okaidia.min.css" rel="stylesheet"/>

    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/prism.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-python.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-javascript.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-ruby.min.js"></script>
    <link rel="stylesheet" href="/assets/markdown.css">

  </head>
  <body>
    <div class="wrapper">
      <aside class="sidebar">
        <a href="/blog/">
          <div class="serio" id="back-button">
            <span class="block-line">
              <span style="color:#00ff6b">←&nbsp;</span>
              <span>
                <span style="color:#2aff00">B</span>
                <span style="color:#ff9300">A</span>
                <span style="color:#c000ff">C</span>
                <span style="color:#ff00c7">K</span></span></span>
          </div>
        </a>
        
        <img src="/assets/blog/0110.png" alt="deco" style="display:block;margin:0 auto;">
      </aside>

      <main>
        <div id="post-header"></div>
        <a href="">CSS Debug Handbook - Layout Essentials</a>
      </br>
      <small>
        1998-01-01
      </small>
      <div class="post-content">
        <blockquote>
<p>这是一个用来整理CSS布局系统核心知识的手册.</p>
</blockquote>
<h2>跳转目录</h2>
<table>
<thead>
<tr>
<th>概念</th>
<th>能解决的问题</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="#box-model---%E5%85%83%E7%B4%A0%E7%9A%84%E8%BE%B9%E7%95%8C%E5%AE%9A%E4%B9%89"><code>box model</code></a></td>
<td>判断元素为什么大小不对</td>
</tr>
<tr>
<td><a href="#position---%E4%B8%8D%E5%90%8C%E7%9A%84%E5%9D%90%E6%A0%87%E7%B3%BB"><code>position</code></a></td>
<td>理解脱离文档流的行为（absolute/fixed）</td>
</tr>
<tr>
<td><a href="#display"><code>display</code></a></td>
<td>决定元素是否是块、内联、栅格、弹性盒</td>
</tr>
<tr>
<td><a href="#flex"><code>flex/grid</code></a></td>
<td>布局系统，决定空间如何分配</td>
</tr>
</tbody>
</table>
<h2>Box Model - 元素的边界定义</h2>
<p>已经很熟悉的概念，chrome f12中的elements中有直观的画图演示。不熟悉的是其他属性对Box的影响。</p>
<h2>Position - 不同的坐标系</h2>
<p>position就像不同维度的坐标系统。</p>
<table>
<thead>
<tr>
<th><code>position</code> 值</th>
<th>类比数学里的坐标系</th>
<th>结果</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>static</code>（默认）</td>
<td>全局坐标系（世界坐标）</td>
<td>不能用 top/left 移动</td>
</tr>
<tr>
<td><code>relative</code></td>
<td>局部坐标系</td>
<td>参照元素原本位置偏移（但不脱离文档流）</td>
</tr>
<tr>
<td><code>absolute</code></td>
<td>定点系，但基于最近的定位祖先</td>
<td>完全脱离文档流，可任意定位</td>
</tr>
<tr>
<td><code>fixed</code></td>
<td>屏幕系（视口固定坐标）</td>
<td>页面滚动时也保持原地</td>
</tr>
<tr>
<td><code>sticky</code></td>
<td>条件固定</td>
<td>滚动到某处后“贴住”视口</td>
</tr>
</tbody>
</table>
<p>它到底影响了什么？</p>
<p>首先它影响了坐标系统，决定你设置top / left / right / bottom是相对于谁的。默认static是完全不能用这些属性的。</p>
<p>其次它影响元素是否还在“文档流”里，static / relative 在。absolute / fixed不在，不占位，脱离正常布局。</p>
<p>最后，它影响z-index（图层）
没有position就不能使用z-index，设置了position（除了static），你就有资格开始叠叠乐。</p>
<p>Position和元素尺寸有些间接关系：</p>
<table>
<thead>
<tr>
<th>位置类型</th>
<th>尺寸计算方式</th>
<th>会不会影响外层容器高度</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>static</code></td>
<td>按内容自动撑开</td>
<td>会影响</td>
</tr>
<tr>
<td><code>relative</code></td>
<td>同上 + 视觉偏移（不影响其他元素位置）</td>
<td>会影响</td>
</tr>
<tr>
<td><code>absolute</code></td>
<td>必须显式指定或由子元素撑开</td>
<td>不会影响</td>
</tr>
<tr>
<td><code>fixed</code></td>
<td>同上</td>
<td>不会影响</td>
</tr>
<tr>
<td><code>sticky</code></td>
<td>和relative基本一样，但条件触发变fixed</td>
<td>会影响</td>
</tr>
<tr>
<td>所以absolute/fixed的元素，尺寸不再由周围内容影响，需要手动控制。</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<h3>常见bug和应用</h3>
<p>absolute/fixed适用于精确控制位置（弹窗、提示框、工具栏）</p>
<p>relative适用于相对偏移但不打乱结构，比如按钮内文字偏左点. 对position: relative的元素设top/left，它会移动位置，但仍占原位置的空间(static就无效了)</p>
<p>sticky适用于滚动吸附，如头部导航固定、吸底操作栏（移动端）</p>
<table>
<thead>
<tr>
<th>遇到的痛点</th>
<th>可能的解法</th>
</tr>
</thead>
<tbody>
<tr>
<td>宽度/高度没对齐</td>
<td><code>position</code>可能让它脱离流 → 它不会撑开父容器了</td>
</tr>
<tr>
<td>“贴到哪里”不对</td>
<td>检查是否有最近的<code>position: relative</code>的祖先</td>
</tr>
<tr>
<td>被遮住/层级不对</td>
<td>没有设置<code>z-index</code>，或外层容器层级影响它</td>
</tr>
</tbody>
</table>
<p>豆知识：position: sticky就像是“条件fixed”：</p>
<p>默认是relative</p>
<p>滚动到某个点时自动变成fixed</p>
<pre><code class="language-css">.sticky-header {
  position: sticky;
  top: 0; /* 到这里不动了 */
}
</code></pre>
<h2>Display</h2>
<p>核心问题：一个元素的显示方式是块状、内联，还是栅格 / 弹性布局容器？它能不能包住子元素？子元素的布局规则是什么？</p>
<table>
<thead>
<tr>
<th>值</th>
<th>作用</th>
<th>典型用途</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>block</code></td>
<td>占据整行，可设宽高，自动换行</td>
<td><code>&lt;div&gt;, &lt;section&gt;, &lt;p&gt;, &lt;h1&gt;</code></td>
</tr>
<tr>
<td><code>inline</code></td>
<td>行内显示，不能设宽高，不换行</td>
<td><code>&lt;span&gt;</code>、文本装饰等</td>
</tr>
<tr>
<td><code>inline-block</code></td>
<td>行内排布，但可设宽高,不换行</td>
<td>小按钮、icon等</td>
</tr>
<tr>
<td><code>flex</code></td>
<td>变成弹性布局容器，子元素可弹性分配空间</td>
<td>卡片容器、导航栏、对齐等</td>
</tr>
<tr>
<td><code>grid</code></td>
<td>变成网格布局容器，子元素可占格子</td>
<td>复杂的界面网格，比如画廊、控制面板</td>
</tr>
<tr>
<td><code>none</code></td>
<td>不显示，且从文档流中移除</td>
<td>暂时隐藏元素（但注意不同于 <code>visibility: hidden</code>，none的元素不占据位置，hidden的元素还会占据位置）</td>
</tr>
</tbody>
</table>
<h3>Quick Checklist</h3>
<ul>
<li>[x] content（width 默认只计算 content 部分），<code>box-sizing</code> 默认是 <code>content-box</code>，要手动设为 <code>border-box</code> width才会包含padding和border</li>
<li>[x] inline元素不支持设置<code>width</code> <code>height</code>（需要转为<code>inline-block</code>才生效）</li>
<li>[x] margin collapse发生在垂直方向的<code>block</code>元素之间，当两个上下相邻的 block 元素之间都有margin-top/margin-bottom，它们不会“加起来”，而是合并成一个更大的值。</li>
</ul>
<h3>排查手册</h3>
<p>为什么设置了width没效果？：是不是display: inline？</p>
<p>为什么两个按钮换行了？：可能是display: block或默认布局规则</p>
<p>为什么排不齐？：是不是需要改成flex或grid？</p>
<h2>Flex</h2>
<p>用一句话总结：flex 是“空间分配器”。它能解决的是一类问题：“几个元素横着（或竖着）排，怎么让它们刚好排好、对齐、拉伸、靠边、等分、缩放？”</p>
<h3>结构</h3>
<p>在 Flex 世界里，有两个层次：</p>
<p>外层容器（flex container）加 display: flex</p>
<p>子元素（flex items）自动变成“能被分配空间的对象”</p>
<p>一个 flex 容器可以控制两个方向：</p>
<table>
<thead>
<tr>
<th>方向</th>
<th>属性名</th>
<th>控制啥</th>
</tr>
</thead>
<tbody>
<tr>
<td>主轴（横or竖）</td>
<td><code>flex-direction</code><br><code>justify-content</code></td>
<td>控制子元素如何沿主轴排列</td>
</tr>
<tr>
<td>交叉轴</td>
<td><code>align-items</code><br><code>align-self</code></td>
<td>控制子元素在副轴上的对齐</td>
</tr>
</tbody>
</table>
<p>主轴默认为横向：row，所以justify控横，align控竖。</p>
<h3>flex: <flex-grow> <flex-shrink> <flex-basis></h3>
<ol>
<li>flex-grow：有剩余空间时，谁多长一些？</li>
</ol>
<pre><code class="language-css">    flex-grow: 0; /* 不长 */
    flex-grow: 1; /*分到等量空间*/
    flex-grow: 2; /* 是别人的两倍 */
</code></pre>
<ol start="2">
<li>flex-shrink：空间不够时，谁先变小？</li>
</ol>
<pre><code class="language-css">    flex-shrink: 0; /* no shrinking */
    flex-shrink:1; /* shrink according to scale */
    flex-shrink: 2; /* can shrink more */
</code></pre>
<ol start="3">
<li>flex-basis：原始大小</li>
</ol>
<pre><code class="language-css">    flex-basis: 200px; /* require at least 200px width */
</code></pre>
<p>flex-basis会覆盖width</p>
<p><strong>所以flex: 1是</strong><code>flex: 1 1 0%</code>，等比例长大缩小，从0开始分配剩余空间</p>
<h3>几个常见问题的flex解法模型</h3>
<table>
<thead>
<tr>
<th>想要的效果</th>
<th>设置</th>
</tr>
</thead>
<tbody>
<tr>
<td>全部等宽</td>
<td><code>flex: 1</code></td>
</tr>
<tr>
<td>固定左侧 + 自适右侧</td>
<td><code>.left {flex: 0 0 100px}</code><br><code>.right {flex: 1}</code></td>
</tr>
<tr>
<td>不让缩小</td>
<td><code>flex-shrink: 0</code></td>
</tr>
<tr>
<td>固定宽度优先，空间大了再变大</td>
<td><code>flex: 1 1 200px</code></td>
</tr>
</tbody>
</table>
<h2>Grid</h2>
<p>与flex不同，grid有横竖两个主轴。
<code>grid-template-row/column</code>控制几行/几列；<code>gap</code>控制每个格子间距。</p>
<p>可以自定义比例：</p>
<pre><code class="language-css">grid-template-columns: 1fr 2fr 1fr;
grid-template-columns: 100px auto 200px;
grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); /* auto fit */
</code></pre>
<p>子项跨格：</p>
<pre><code class="language-css">grid-column: 1 / 3; /* takes up col 1-3 (3rd excluded) */
grid-area: 2 / 1 / 4 / 3; /* row-start / column-start / row-end / column-end */
</code></pre>

      </div>
    </br>
    <p>Tags:
      &nbsp
      blog, Frontend
    </p>
  </main>

</div>
</body>
</html>